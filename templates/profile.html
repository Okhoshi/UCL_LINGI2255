{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load extra_tags %}


{% block breadcrumb %}
<ol class="breadcrumb">
	<li><a href="/">{% trans "Home" %}</a></li>
	<li><a href="#">{% trans "Members" %}</a></li>
	<li class="active">{{ profile_name }}</li>
</ol>
{% endblock %}


{% block content %}
	<div class="col-sm-2" style="text-align:center;">
        <div class="row">
            {% if not image or image == 'null' %}
            <img src="{% static 'images/default_avatar.jpg' %}" alt="Username" class="img-thumbnail img-responsive" style="margin: auto 0">
            {% else %}
            <img src="{{ MEDIA_URL }}{{ image }}" alt="Username" class="img-thumbnail img-responsive" style="margin: auto 0">
            {% endif %}
            {% if my_profile == False %}
            <a class="btn btn-primary btn-xs" style="margin-top:1em; width:10em"
               href="{% url 'profile' %}?profile_id={{ profile_id }}">
                {% trans "Follow" %}
            </a>
            {% endif %}
        </div>
	</div>

	<div class="col-sm-10">
		<h4 style="pull-left">{{ profile_name }} &nbsp; {% if is_verified %}<span class="label label-success" style="font-size:0.7em;">{% trans "Verified" %}</span>{% endif %}</h4>
		<hr>
		{% if global_rating.1 > 0 %}
			{{ global_rating.0 }}% {% trans "of positive evaluations." %} ({{ global_rating.1 }} {% trans "evaluations"%})
		{% else %}
			{% trans "No evaluations" %}
		{% endif %}
		{% if is_association_user|length > 0 %}
			{{ entity.description }}
		{% endif %}
		

		<div class="clearfix" style="margin-top: 30px"></div>

		<!--
		##################
		##### GROUPS #####
		##################
		-> NOT USED
		<div class="col-xs-2" style="padding: 0px;">
			<label>Groups</label>
		</div>

		<div class="col-xs-10" style="padding: 0px;">
			Social group X<br />
			Social group Y<br />
			Social group Z
		</div>
		<div class="clearfix" style="margin-top: 12px">&nbsp;</div>
		<!--
		##########################
		##### CURRENT OFFERS #####
		##########################
		-->
		<div class="col-md-2" style="padding: 0px;">
			<label>{% trans "Current offers" %}</label>
		</div>
		<div class="col-md-10" style="padding: 0px;">
			<table class="table table-striped table-bordered">
				<tr>
					<th style="width: 50%">{% trans "Name" %}</th>
					<th style="width: 25%">{% trans "Demander" %}</th>
					<th style="width: 25%">{% trans "Date" %}</th>
				</tr>
				{% for elem in current_offers %}
				<tr>
                    {% include 'request_details.html' %}
					<td data-toggle="modal" data-target="#TON_ID_ICI{{ elem.0.id }}" style="cursor: pointer;">{{ elem.0.name }}</td>

					<td>
						{% if elem.2 %}
							<form action="/profile/" method="POST">
                        	{% csrf_token %}
                        	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
                        	{{ elem.2 }}
                        	</button>
                        	<input name="profile_id" value="{{ elem.0.demander.id }}" type="hidden" readonly/>
                   	 		</form>
                   	 	{% else %}
                   	 		/
                   	 	{% endif %}					
					</td>
					<td>{{ elem.3 }}</td>		
		
				</tr>
				{% endfor %}

			</table>
		</div>

		<!--
		###########################
		##### CURRENT DEMANDS #####
		###########################
		-->
		<div class="col-md-2" style="padding: 0px;">
			<label>{% trans "Current demands" %}</label>
		</div>
		<div class="col-md-10" style="padding: 0px;">
			<table class="table table-striped table-bordered">
				<tr>
					<th style="width: 50%">{% trans "Name" %}</th>
					<th style="width: 25%">{% trans "Proposer" %}</th>
					<th style="width: 25%">{% trans "Date" %}</th>
				</tr>
				{% for elem in current_demands %}
				<tr>
                    {% include 'request_details.html' %}
					<td data-toggle="modal" data-target="#TON_ID_ICI{{ elem.0.id }}" style="cursor: pointer;">{{ elem.0.name }}</td>
					<td>
						{% if elem.1 %}
							<form action="/profile/" method="POST">
                        	{% csrf_token %}
                        	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
                        	{{ elem.1 }}
                        	</button>
                        	<input name="profile_id" value="{{ elem.0.proposer.id }}" type="hidden" readonly/>
                   	 		</form>
                   	 	{% else %}
                   	 		/
                   	 	{% endif %}					
					</td>
					<td>{{ elem.3 }}</td>				
				</tr>
				{% endfor %}

			</table>
		</div>

		<!--
		###################
		##### HISTORY #####
		###################
		-->
		<div class="col-md-2" style="padding: 0px;">
			<label>{% trans "History" %}</label>
		</div>
		<div class="col-md-10" style="padding: 0px;">
			<table class="table table-striped table-bordered">
				<tr>
					<th style="width: 40%">{% trans "Name" %}</th>
					<th style="width: 10%">{% trans "Action" %}</th>
					<th style="width: 25%">{% trans "With" %}</th>
					<th style="width: 25%">{% trans "Date" %}</th>
				</tr>
				{% for elem in old_requests %}
				<tr>
                    {% include 'request_details.html' %}
					<td data-toggle="modal" data-target="#TON_ID_ICI{{ elem.0.id }}" style="cursor: pointer;">{{ elem.0.name }}</td>
					<td>
					{% if elem.3 %}
						{{ 'proposed' }}
					{% else %}
						{{ 'demanded' }}
					{% endif %}
					</td>
					<td>
					{% if elem.3 %}
						<form action="/profile/" method="POST">
                       	{% csrf_token %}
	                       	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
	                       	{{ elem.4 }}
	                       	</button>
	                       	<input name="profile_id" value="{{ elem.0.demander.id }}" type="hidden" readonly/>
                 	 	</form>
					{% else %}
						<form action="/profile/" method="POST">
                        	{% csrf_token %}
                        	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
                        	{{ elem.4 }}
                        	</button>
                        	<input name="profile_id" value="{{ elem.0.proposer.id }}" type="hidden" readonly/>
                   	 	</form>
					{% endif %}
					</td>
					<td>{{ elem.5 }}</td>			
				</tr>
				{% endfor %}
			</table>
		</div>

		<!--
		########################
		##### EVAL HISTORY #####
		########################
		-->
		<div class="col-md-2" style="padding: 0px;">
			<label>{% trans "Evaluations summary" %}</label>
		</div>
		<div class="col-md-10" style="padding: 0px;">
			<table class="table table-striped table-bordered">
				<tr>
					<th style="width: 30%">{% trans "Name" %}</th>
					<th style="width: 20%">{% trans "With" %}</th>
					<th style="width: 50%">{% trans "Evaluation" %}</th>
				</tr>
				{% for elem in feedbacks %}
				<tr class={{ elem.1 }}>
					{% include 'request_details.html' %}
					<td data-toggle="modal" data-target="#TON_ID_ICI{{ elem.0.id }}" style="cursor: pointer;">{{ elem.0.name }}</td>
					<td>
					{% if elem.5 %}
						<form action="/profile/" method="POST">
                       	{% csrf_token %}
	                       	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
	                       	{{ elem.3 }}
	                       	</button>
	                       	<input name="profile_id" value="{{ elem.0.demander.id }}" type="hidden" readonly/>
                 	 	</form>
					{% else %}
						<form action="/profile/" method="POST">
                        	{% csrf_token %}
                        	<button type="submit" style="padding-left:0; background: transparent none; border: 0 none;">
                        	{{ elem.3 }}
                        	</button>
                        	<input name="profile_id" value="{{ elem.0.proposer.id }}" type="hidden" readonly/>
                   	 	</form>
					{% endif %}
					</td>
					<td>{{ elem.4 }}</td>			
				</tr>
				{% endfor %}

			</table>
		</div>
	</div>
{% endblock %}

